<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8">
<style>
    .links line {
        stroke: #999;
        stroke-opacity: 0.6;
    }

    text {
        font-size: 1em;
        font-weight: bold;
        -webkit-font-smoothing: antialiased;
    }
</style>

</head><body><svg width="960" height="600"><g class="links"><line stroke-width="2.23606797749979" x1="474.31707196622693" y1="376.92682453876193" x2="556.1039185505696" y2="332.5567922926065"></line><line stroke-width="2.23606797749979" x1="474.31707196622693" y1="376.92682453876193" x2="482.9793030557816" y2="213.72819139928603"></line><line stroke-width="2.23606797749979" x1="474.31707196622693" y1="376.92682453876193" x2="563.1289174394238" y2="254.23262186347546"></line><line stroke-width="2.23606797749979" x1="474.31707196622693" y1="376.92682453876193" x2="408.538859480917" y2="460.2970606460998"></line><line stroke-width="2.23606797749979" x1="474.31707196622693" y1="376.92682453876193" x2="362.757732656591" y2="412.25173255556916"></line><line stroke-width="2.23606797749979" x1="556.1039185505696" y1="332.5567922926065" x2="482.9793030557816" y2="213.72819139928603"></line><line stroke-width="2.23606797749979" x1="556.1039185505696" y1="332.5567922926065" x2="462.5526545919729" y2="274.3097858837568"></line><line stroke-width="2.23606797749979" x1="482.9793030557816" y1="213.72819139928603" x2="563.1289174394238" y2="254.23262186347546"></line><line stroke-width="2.23606797749979" x1="482.9793030557816" y1="213.72819139928603" x2="399.13897453856987" y2="181.05523375897883"></line><line stroke-width="2.23606797749979" x1="563.1289174394238" y1="254.23262186347546" x2="610.5040225145904" y2="194.66836908017623"></line><line stroke-width="2.23606797749979" x1="408.538859480917" y1="460.2970606460998" x2="362.757732656591" y2="412.25173255556916"></line><line stroke-width="2.23606797749979" x1="399.13897453856987" y1="181.05523375897883" x2="462.5526545919729" y2="274.3097858837568"></line></g><g class="nodes"><g><circle id="parent-pie" r="20" fill="#1f77b4" stroke="#1f77b4" stroke-width="12" cx="474.31707196622693" cy="376.92682453876193"></circle><circle r="10" fill="transparent" style="stroke: rgb(214, 39, 40); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="474.31707196622693" cy="376.92682453876193"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 50.2655, 62.8319;" cx="474.31707196622693" cy="376.92682453876193"></circle><circle r="10" fill="transparent" style="stroke: rgb(255, 127, 14); stroke-width: 20; stroke-dasharray: 37.6991, 62.8319;" cx="474.31707196622693" cy="376.92682453876193"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 25.1327, 62.8319;" cx="474.31707196622693" cy="376.92682453876193"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="474.31707196622693" cy="376.92682453876193"></circle><text fill="#1f77b4" dy="40" x="474.31707196622693" y="376.92682453876193">a</text></g><g><circle id="parent-pie" r="20" fill="#ff7f0e" stroke="#ff7f0e" stroke-width="12" cx="556.1039185505696" cy="332.5567922926065"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="556.1039185505696" cy="332.5567922926065"></circle><circle r="10" fill="transparent" style="stroke: rgb(255, 127, 14); stroke-width: 20; stroke-dasharray: 41.89, 62.8319;" cx="556.1039185505696" cy="332.5567922926065"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 20.9419, 62.8319;" cx="556.1039185505696" cy="332.5567922926065"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="556.1039185505696" cy="332.5567922926065"></circle><text fill="#ff7f0e" dy="40" x="556.1039185505696" y="332.5567922926065">b</text></g><g><circle id="parent-pie" r="20" fill="#2ca02c" stroke="#2ca02c" stroke-width="12" cx="482.9793030557816" cy="213.72819139928603"></circle><circle r="10" fill="transparent" style="stroke: rgb(214, 39, 40); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="482.9793030557816" cy="213.72819139928603"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 47.1239, 62.8319;" cx="482.9793030557816" cy="213.72819139928603"></circle><circle r="10" fill="transparent" style="stroke: rgb(255, 127, 14); stroke-width: 20; stroke-dasharray: 31.4159, 62.8319;" cx="482.9793030557816" cy="213.72819139928603"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 15.708, 62.8319;" cx="482.9793030557816" cy="213.72819139928603"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="482.9793030557816" cy="213.72819139928603"></circle><text fill="#2ca02c" dy="40" x="482.9793030557816" y="213.72819139928603">c</text></g><g><circle id="parent-pie" r="20" fill="#d62728" stroke="#d62728" stroke-width="12" cx="563.1289174394238" cy="254.23262186347546"></circle><circle r="10" fill="transparent" style="stroke: rgb(214, 39, 40); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="563.1289174394238" cy="254.23262186347546"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 41.8837, 62.8319;" cx="563.1289174394238" cy="254.23262186347546"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 20.9419, 62.8319;" cx="563.1289174394238" cy="254.23262186347546"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="563.1289174394238" cy="254.23262186347546"></circle><text fill="#d62728" dy="40" x="563.1289174394238" y="254.23262186347546">d</text></g><g><circle id="parent-pie" r="20" fill="#1f77b4" stroke="#1f77b4" stroke-width="12" cx="408.538859480917" cy="460.2970606460998"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="408.538859480917" cy="460.2970606460998"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="408.538859480917" cy="460.2970606460998"></circle><text fill="#1f77b4" dy="40" x="408.538859480917" y="460.2970606460998">e</text></g><g><circle id="parent-pie" r="20" fill="#1f77b4" stroke="#1f77b4" stroke-width="12" cx="362.757732656591" cy="412.25173255556916"></circle><circle r="10" fill="transparent" style="stroke: rgb(31, 119, 180); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="362.757732656591" cy="412.25173255556916"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="362.757732656591" cy="412.25173255556916"></circle><text fill="#1f77b4" dy="40" x="362.757732656591" y="412.25173255556916">f</text></g><g><circle id="parent-pie" r="20" fill="#ff7f0e" stroke="#ff7f0e" stroke-width="12" cx="462.5526545919729" cy="274.3097858837568"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="462.5526545919729" cy="274.3097858837568"></circle><circle r="10" fill="transparent" style="stroke: rgb(255, 127, 14); stroke-width: 20; stroke-dasharray: 31.4159, 62.8319;" cx="462.5526545919729" cy="274.3097858837568"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="462.5526545919729" cy="274.3097858837568"></circle><text fill="#ff7f0e" dy="40" x="462.5526545919729" y="274.3097858837568">g</text></g><g><circle id="parent-pie" r="20" fill="#2ca02c" stroke="#2ca02c" stroke-width="12" cx="399.13897453856987" cy="181.05523375897883"></circle><circle r="10" fill="transparent" style="stroke: rgb(44, 160, 44); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="399.13897453856987" cy="181.05523375897883"></circle><circle r="10" fill="transparent" style="stroke: rgb(255, 127, 14); stroke-width: 20; stroke-dasharray: 31.4159, 62.8319;" cx="399.13897453856987" cy="181.05523375897883"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="399.13897453856987" cy="181.05523375897883"></circle><text fill="#2ca02c" dy="40" x="399.13897453856987" y="181.05523375897883">h</text></g><g><circle id="parent-pie" r="20" fill="#d62728" stroke="#d62728" stroke-width="12" cx="610.5040225145904" cy="194.66836908017623"></circle><circle r="10" fill="transparent" style="stroke: rgb(214, 39, 40); stroke-width: 20; stroke-dasharray: 62.8319, 62.8319;" cx="610.5040225145904" cy="194.66836908017623"></circle><circle r="20" fill="transparent" stroke="white" stroke-width="2" cx="610.5040225145904" cy="194.66836908017623"></circle><text fill="#d62728" dy="40" x="610.5040225145904" y="194.66836908017623">i</text></g></g></svg>

<script src="index_files/d3.js"></script>
<script src="index_files/node-pie.js"></script>

<script>
    
    var svg = d3.select("svg"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

    var color = d3.scaleOrdinal(d3.schemeCategory10);

    var simulation = d3.forceSimulation()
            .force("link", d3.forceLink().id(function (d) {
                return d.id;
            }))
            .force("charge", d3.forceManyBody().strength(-900))
            .force("center", d3.forceCenter(width / 2, height / 2));

    d3.json("data.json", function (error, graph) {
        if (error) throw error;

        var link = svg.append("g")
                .attr("class", "links")
                .selectAll("line")
                .data(graph.links)
                .enter().append("line")
                .attr("stroke-width", function (d) {
                    return Math.sqrt(d.value);
                });

        var node = svg.append("g")
                .attr("class", "nodes")
                .selectAll("g")
                .data(graph.nodes)
                .enter()
                .append("g")
                .call(d3.drag()
                        .on("start", dragstarted)
                        .on("drag", dragged)
                        .on("end", dragended));

        /* Draw the respective pie chart for each node */
        node.each(function (d) {
            NodePieBuilder.drawNodePie(d3.select(this), d.pieChart, {
                parentNodeColor: color(d.group),
                outerStrokeWidth: 12,
                showLabelText: true,
                labelText: d.id,
                labelColor: color(d.group)
            });
        });

        simulation
                .nodes(graph.nodes)
                .on("tick", ticked);

        simulation.force("link")
                .links(graph.links);

        function ticked() {
            link
                    .attr("x1", function (d) {
                        return d.source.x;
                    })
                    .attr("y1", function (d) {
                        return d.source.y;
                    })
                    .attr("x2", function (d) {
                        return d.target.x;
                    })
                    .attr("y2", function (d) {
                        return d.target.y;
                    });

            d3.selectAll("circle").attr("cx", function (d) {
                        return d.x;
                    })
                    .attr("cy", function (d) {
                        return d.y;
                    });

            d3.selectAll("text").attr("x", function (d) {
                        return d.x;
                    })
                    .attr("y", function (d) {
                        return d.y;
                    });
        }
    });

    function dragstarted(d) {
        if (!d3.event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
    }
    
</script></body></html>